<?xml version="1.0" encoding="utf-16"?>
<ZL_OBJECT CHECKSUM="FB6F6824A7C34A13A32E80D3C18B1B9F" CODE_SIGNATURE="31ACDA0973C048524C88A44600FE946F" CONNECTOR="39AC0A4B07A5A05AE1000000AC120173" NAME="YGPL_MT_INFORMATIONS" TYPE="CLAS" VERSION="1.01">
 <DEPENDENCIES>
  <ITEM TYPE="CLAS" NAME="YGPL_MT_CATEGORIES"/>
 </DEPENDENCIES>
 <DIRECTORY DEVCLASS="YGPL-MULTITHREAD" MASTERLANG="E"/>
 <RAW>
  <A0_MAINDATA VERSION="1" LANGU="E" EXPOSURE="2" STATE="1" CLSCCINCL="X" FIXPT="X" UNICODE="X">
   <TEXTS>
    <ITEM LANG="E" TEXT="Information communication between process"/>
   </TEXTS>
  </A0_MAINDATA>
  <ALIASES>
   <ITEM CMPNAME="SYS_CATEGORIES" EXPOSURE="1" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="SYS_CATEGORIES"/>
   <ITEM CMPNAME="TD_BOOLEAN" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TD_BOOLEAN"/>
   <ITEM CMPNAME="TD_CATEGORY" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TD_CATEGORY"/>
   <ITEM CMPNAME="TD_COUNT" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TD_COUNT"/>
   <ITEM CMPNAME="TD_DATA_TYPE" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TD_DATA_TYPE"/>
   <ITEM CMPNAME="TD_DB_TABLE_NAME" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TD_DB_TABLE_NAME"/>
   <ITEM CMPNAME="TD_LOCK_MODE" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TD_LOCK_MODE"/>
   <ITEM CMPNAME="TD_PROCESS_ID" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TD_PROCESS_ID"/>
   <ITEM CMPNAME="TD_RAWDATA" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TD_RAWDATA"/>
   <ITEM CMPNAME="TD_TIME" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TD_TIME"/>
   <ITEM CMPNAME="TD_TIMESTAMP" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TD_TIMESTAMP"/>
   <ITEM CMPNAME="TR_CATEGORIES" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TR_CATEGORIES"/>
   <ITEM CMPNAME="TS_RUN" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TS_RUN"/>
   <ITEM CMPNAME="TT_STATUS_LIST" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TT_STATUS_LIST"/>
  </ALIASES>
  <ATTRIBUTS>
   <ITEM CMPNAME="MY_TABLE" STATE="1" ATTDECLTYP="2" ATTVALUE="&apos;YGPLMT_INFOS&apos;" TYPTYPE="1" TYPE="TD_DB_TABLE_NAME">
    <TEXTS>
     <ITEM LANG="E" TEXT="Table name of the main table used by this component"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="O_PROCESS" EXPOSURE="2" STATE="1" ATTRDONLY="X" TYPTYPE="1" TYPE="TO_PROCESS">
    <TEXTS>
     <ITEM LANG="E" TEXT="Process for MultiThread (with category)"/>
    </TEXTS>
   </ITEM>
  </ATTRIBUTS>
  <DEFERRED>
   <CLASSES>
    <ITEM TYPEGROUP="YGPL_MT_CATEGORIES" TPUTYPE="1" EXPLICIT="X"/>
   </CLASSES>
  </DEFERRED>
  <EVENTS>
   <ITEM CMPNAME="HANDLE_SPECIFIC_MESSAGE" EXPOSURE="2" STATE="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Event raised when specific message recieved"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CAT" CMPTYPE="2" PARDECLTYP="1" TYPTYPE="1" TYPE="TD_CATEGORY">
      <TEXTS>
       <ITEM LANG="E" TEXT="Message Category"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RAWDATA" CMPTYPE="2" PARDECLTYP="1" TYPTYPE="1" TYPE="TD_RAWDATA">
      <TEXTS>
       <ITEM LANG="E" TEXT="Message to handle"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
   </ITEM>
   <ITEM CMPNAME="OBJECTS_CONFIRMED" EXPOSURE="2" STATE="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Event to handle objects status update (count raised)"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="OBJECT_COUNT" CMPTYPE="2" PARDECLTYP="1" TYPTYPE="1" TYPE="TD_COUNT">
      <TEXTS>
       <ITEM LANG="E" TEXT="Number of object confirmed"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="STATUS" CMPTYPE="2" PARDECLTYP="1" TYPTYPE="1" TYPE="TT_STATUS_LIST">
      <TEXTS>
       <ITEM LANG="E" TEXT="Detailed status count"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
   </ITEM>
  </EVENTS>
  <INTERFACES>
   <ITEM REFCLSNAME="YGPL_MT_TYPES" EXPOSURE="2" STATE="1" RELTYPE="1"/>
  </INTERFACES>
  <LOCAL>
   <TYPES>`
*&quot;* use this source file for any type declarations (class
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* implementation or private method&apos;s signature</TYPES>
   <IMPLEMENTATIONS>`
*&quot;* local class implementation for public class
*&quot;* use this source file for the implementation part of
*&quot;* local helper classes</IMPLEMENTATIONS>
   <MACROS>`
*&quot;* use this source file for any macro definitions you need
*&quot;* in the implementation part of the class</MACROS>
  </LOCAL>
  <METHODS>
   <ITEM CMPNAME="CLEAR_INFORMATION" EXPOSURE="2" STATE="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Clear information on DB"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CATEGORY" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CATEGORY">
      <TEXTS>
       <ITEM LANG="E" TEXT="Information Category"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="FAILED" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="Delete has failed"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
**********************************************************************
* Author : Al&apos;oustad Taryck BENSIALI (taryck.bensiali@gmail.com)     *
* Date : 2008 December                                               *
**********************************************************************

  lock_exclusive( category ).

  DELETE FROM ygplmt_infos
         WHERE process_id = o_process-&gt;process_id
           and   CATEGORY = category.
* Locks released by the next Commit/Roll back</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CONSTRUCTOR" EXPOSURE="2" STATE="1" MTDTYPE="2">
    <TEXTS>
     <ITEM LANG="E" TEXT="CONSTRUCTOR"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="O_PROCESS" CMPTYPE="1" MTDTYPE="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TO_PROCESS">
      <TEXTS>
       <ITEM LANG="E" TEXT="Process for MultiThread (with category)"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  ASSERT o_process IS BOUND.
  me-&gt;o_process = o_process.
  ASSERT me-&gt;o_process-&gt;o_categories IS BOUND.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="DECODE_DATA" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Decode data to buffer"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="ANY" CMPTYPE="1" PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
     <ITEM SCONAME="BUFFER" CMPTYPE="1" TYPTYPE="1" TYPE="TD_BUFFER_DATA">
      <TEXTS>
       <ITEM LANG="E" TEXT="Raw Data for export/import to database"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  IMPORT info = any FROM DATA BUFFER buffer.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="DELETE_ALL" EXPOSURE="2" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Delete all messages"/>
    </TEXTS>
    <SOURCE>`
  DATA user TYPE sy-uname.

* Locks released by the next Commit/Roll back
*  _lock( process_id = &apos;@&apos;
*          lock_mode = ygpl_mt_lock_managment=&gt;lock_modes-exclusive
*           category = &apos;@&apos; ).    &quot; All Categories
  CALL FUNCTION &apos;ENQUEUE_EYGPLMT_INFOS&apos;
    EXPORTING
      mode_ygplmt_infos = ygpl_mt_lock_managment=&gt;lock_modes-exclusive
      mandt             = sy-mandt
      process_id        = &apos;@&apos;
      category          = space
      x_process_id      = abap_true
      x_category        = abap_false
      _scope            = &apos;2&apos;
      _wait             = abap_true
      _collect          = &apos; &apos;
    EXCEPTIONS
      foreign_lock      = 1
      system_failure    = 2
      OTHERS            = 3.
  IF sy-subrc = 1.
    user = sy-msgv1.
    RAISE EXCEPTION TYPE ygpl_mt_cx_locks
          EXPORTING textid = ygpl_mt_cx_locks=&gt;foreign_lock
                  object_name = &apos;MT Informations&apos;(lon)
                   object_key = &apos;*&apos;
                         user = user.
*  else if sy-subrc &lt;&gt; 0.
  ELSE.
    ASSERT sy-subrc = 0.
  ENDIF.

  DELETE FROM ygplmt_infos.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="DELETE_PROCESS" EXPOSURE="2" STATE="1" MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Delete all message for a process"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="PROCESS_ID" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROCESS_ID">
      <TEXTS>
       <ITEM LANG="E" TEXT="ID unique de l&apos;exécution"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="YGPL_MT_CX" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="MultyThread : Root exception class"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  _lock( process_id = process_id
          lock_mode = ygpl_mt_lock_managment=&gt;lock_modes-exclusive
           category = &apos;@&apos; ).    &quot; All Categories
* Locks released by the next Commit/Roll back

  DELETE FROM ygplmt_infos WHERE process_id = process_id.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="ENCODE_DATA" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Encode data to buffer"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="ANY" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
     <ITEM SCONAME="RESULT" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TD_BUFFER_DATA">
      <TEXTS>
       <ITEM LANG="E" TEXT="Raw Data for export/import to database"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  EXPORT info = any TO DATA BUFFER result COMPRESSION ON.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_INFORMATION" EXPOSURE="2" STATE="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Read information from DB"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CATEGORY" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CATEGORY">
      <TEXTS>
       <ITEM LANG="E" TEXT="Information Category"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="INFO" CMPTYPE="1" PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY">
      <TEXTS>
       <ITEM LANG="E" TEXT="Information stored"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="YGPL_MT_CX" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="MultyThread : Root exception class"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA data_info  TYPE td_buffer_data.
  DATA o_cx       TYPE REF TO ygpl_mt_cx.
  DATA my_key     TYPE string.

  CHECK NOT o_process-&gt;o_categories-&gt;is_valid_category( category ) IS INITIAL.

  lock_with_share( category ).
  TRY.
      SELECT SINGLE info_data
        INTO data_info
        FROM ygplmt_infos
        WHERE process_id = o_process-&gt;process_id
          AND category = category.
      IF sy-subrc &lt;&gt; 0.
        my_key = o_process-&gt;process_id.
        RAISE EXCEPTION TYPE ygpl_mt_cx_database
              EXPORTING textid = ygpl_mt_cx_database=&gt;not_found
                     tablename = my_table
                     key_value = my_key.
      ENDIF.

      decode_data( EXPORTING buffer = data_info
                    CHANGING    any = info ).

    CATCH ygpl_mt_cx INTO o_cx.
      unlock_with_share( category ).
      RAISE EXCEPTION o_cx.
  ENDTRY.
  unlock_with_share( category ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="LOCK_EXCLUSIVE" EXPOSURE="1" STATE="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Lock record exclusive"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CATEGORY" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CATEGORY" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANG="E" TEXT="Catégorie de donnée supplémentaire"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="YGPL_MT_CX" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="MultyThread : Root exception class"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  _lock( lock_mode = ygpl_mt_lock_managment=&gt;lock_modes-write
        process_id = o_process-&gt;process_id
          category = category ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="LOCK_WITH_SHARE" EXPOSURE="1" STATE="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Lock record &amp; sharing"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CATEGORY" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CATEGORY">
      <TEXTS>
       <ITEM LANG="E" TEXT="Information Category"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="YGPL_MT_CX" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="MultyThread : Root exception class"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  _lock( lock_mode = ygpl_mt_lock_managment=&gt;lock_modes-read
        process_id = o_process-&gt;process_id
          category = category ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="SET_INFORMATION" EXPOSURE="2" STATE="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Write information to DB"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CATEGORY" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CATEGORY">
      <TEXTS>
       <ITEM LANG="E" TEXT="Information Category"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="INFO" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY">
      <TEXTS>
       <ITEM LANG="E" TEXT="Information to strore"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="YGPL_MT_CX" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="MultyThread : Root exception class"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
**********************************************************************
* Author : Al&apos;oustad Taryck BENSIALI (taryck.bensiali@gmail.com)     *
* Date : 2008 December                                               *
**********************************************************************
  DATA _info TYPE ygplmt_infos.
  DATA o_cx TYPE REF TO ygpl_mt_cx.

  CHECK NOT o_process-&gt;o_categories-&gt;is_valid_category( category ) IS INITIAL.

  lock_exclusive( category ).
* Locks released by the next Commit/Roll back
  TRY.

      _info-process_id = o_process-&gt;process_id.
      _info-category = category.
      _info-info_data = encode_data( info ).
      GET TIME STAMP FIELD _info-timestamp.
      MODIFY ygplmt_infos FROM _info.
      ASSERT sy-subrc = 0.

    CATCH ygpl_mt_cx INTO o_cx.
      unlock_exclusive( category ).
      RAISE EXCEPTION o_cx.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="UNLOCK_EXCLUSIVE" EXPOSURE="1" STATE="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Unlock record (with exclusive option)"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CATEGORY" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CATEGORY" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANG="E" TEXT="Catégorie de donnée supplémentaire"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  _unlock( lock_mode = ygpl_mt_lock_managment=&gt;lock_modes-write
          process_id = o_process-&gt;process_id
            category = category ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="UNLOCK_WITH_SHARE" EXPOSURE="1" STATE="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Unlock record (lock with sharing option)"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CATEGORY" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CATEGORY">
      <TEXTS>
       <ITEM LANG="E" TEXT="Information Category"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  _unlock( lock_mode = ygpl_mt_lock_managment=&gt;lock_modes-read
          process_id = o_process-&gt;process_id
            category = category ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="_LOCK" STATE="1" MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Locking"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CATEGORY" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CATEGORY">
      <TEXTS>
       <ITEM LANG="E" TEXT="Information Category"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="LOCK_MODE" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_LOCK_MODE">
      <TEXTS>
       <ITEM LANG="E" TEXT="Lock mode (E, S, X)"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="PROCESS_ID" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROCESS_ID">
      <TEXTS>
       <ITEM LANG="E" TEXT="Process ID"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="TIMEOUT" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_TIME" PARVALUE="60">
      <TEXTS>
       <ITEM LANG="E" TEXT="Timeout value (second)"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="YGPL_MT_CX" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="MultyThread : Root exception class"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA _key TYPE string.
  DATA user TYPE sy-uname.

  ygpl_mt_lock_managment=&gt;get_information_clearance( process_id ).

  ygpl_mt_lock_managment=&gt;check_lock_mode( lock_mode ).

  ygpl_mt_lock_managment=&gt;set_timeout_timestamp( timeout ).
  DO.
    CALL FUNCTION &apos;ENQUEUE_EYGPLMT_INFOS&apos;
      EXPORTING
        mode_ygplmt_infos = lock_mode
        mandt             = sy-mandt
        process_id        = process_id
        category          = category
        x_process_id      = abap_true
        x_category        = abap_true
        _scope            = &apos;2&apos;
        _wait             = abap_true
        _collect          = &apos; &apos;
      EXCEPTIONS
        foreign_lock      = 1
        system_failure    = 2
        OTHERS            = 3.
    IF sy-subrc = 1.
      IF ygpl_mt_lock_managment=&gt;check_timeout( ) IS INITIAL.
        CONTINUE.
      ELSE.
        user = sy-msgv1.
        _key = process_id.
        CONCATENATE _key &apos;-&apos; category INTO _key.
        RAISE EXCEPTION TYPE ygpl_mt_cx_locks
              EXPORTING textid = ygpl_mt_cx_locks=&gt;foreign_lock
                      object_name = &apos;MT Informations&apos;(lon)
                       object_key = _key
                             user = user.
      ENDIF.
*  else if sy-subrc &lt;&gt; 0.
    ELSE.
      ASSERT sy-subrc = 0.
    ENDIF.
    CALL FUNCTION &apos;YGPL_DO_NOTHING&apos; IN UPDATE TASK.
    EXIT.
  ENDDO.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="_UNLOCK" STATE="1" MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Unlocking"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CATEGORY" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_CATEGORY" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANG="E" TEXT="Information Category"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="LOCK_MODE" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_LOCK_MODE">
      <TEXTS>
       <ITEM LANG="E" TEXT="Lock mode (E, S, X)"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="PROCESS_ID" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROCESS_ID">
      <TEXTS>
       <ITEM LANG="E" TEXT="Process ID"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="YGPL_MT_CX" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="MultyThread : Root exception class"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  ygpl_mt_lock_managment=&gt;check_lock_mode( lock_mode ).

  CALL FUNCTION &apos;DEQUEUE_EYGPLMT_INFOS&apos;
    EXPORTING
      mode_ygplmt_infos = lock_mode
      mandt             = sy-mandt
      process_id        = process_id
      category          = category
      x_process_id      = abap_true
      x_category        = abap_true
      _scope            = &apos;2&apos;
      _synchron         = &apos; &apos;
      _collect          = &apos; &apos;.

  ygpl_mt_lock_managment=&gt;release_information_clearance( process_id ).</SOURCE>
   </ITEM>
  </METHODS>
  <TYPEGROUPS>
   <ITEM TYPEGROUP="ABAP" EXPLICIT="X"/>
  </TYPEGROUPS>
  <TYPES>
   <ITEM CMPNAME="TD_BUFFER_DATA" STATE="1" EDITORDER="1 " TYPTYPE="1" TYPE="YGPLMT_INFOS-INFO_DATA">
    <TEXTS>
     <ITEM LANG="E" TEXT="Raw Data for export/import to database"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TO_PROCESS" EXPOSURE="2" STATE="1" TYPTYPE="3" TYPE="YGPL_MT_PROCESS_4MT">
    <TEXTS>
     <ITEM LANG="E" TEXT="Process for MultiThread (with category)"/>
    </TEXTS>
   </ITEM>
  </TYPES>
 </RAW>
</ZL_OBJECT>
