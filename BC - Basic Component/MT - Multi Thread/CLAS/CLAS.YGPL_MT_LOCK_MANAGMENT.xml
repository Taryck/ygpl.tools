<?xml version="1.0" encoding="utf-16"?>
<ZL_OBJECT CHECKSUM="3EA6965A249AC87AF37069A878AB360A" CODE_SIGNATURE="B446AE06E4C6ED76499A438687547E24" CONNECTOR="39AC0A4B07A5A05AE1000000AC120173" NAME="YGPL_MT_LOCK_MANAGMENT" TYPE="CLAS" VERSION="1.01">
 <DIRECTORY DEVCLASS="YGPL-MULTITHREAD" MASTERLANG="E"/>
 <RAW>
  <A0_MAINDATA VERSION="1" LANGU="E" EXPOSURE="2" STATE="1" CLSCCINCL="X" FIXPT="X" UNICODE="X">
   <TEXTS>
    <ITEM LANG="E" TEXT="MT Framework : Lock Managment"/>
   </TEXTS>
  </A0_MAINDATA>
  <ALIASES>
   <ITEM CMPNAME="ACTIONS" EXPOSURE="2" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="ACTIONS"/>
   <ITEM CMPNAME="LOCK_MODES" EXPOSURE="2" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="LOCK_MODES"/>
   <ITEM CMPNAME="SYS_CATEGORIES" EXPOSURE="2" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="SYS_CATEGORIES"/>
   <ITEM CMPNAME="TD_BOOLEAN" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TD_BOOLEAN"/>
   <ITEM CMPNAME="TD_LOCK_MODE" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TD_LOCK_MODE"/>
   <ITEM CMPNAME="TD_PROCESS_ID" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TD_PROCESS_ID"/>
   <ITEM CMPNAME="TD_TIME" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TD_TIME"/>
   <ITEM CMPNAME="TD_TIMESTAMP" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="YGPL_MT_TYPES" REFCMPNAME="TD_TIMESTAMP"/>
  </ALIASES>
  <ATTRIBUTS>
   <ITEM CMPNAME="TIMEOUT" STATE="1" ATTDECLTYP="1" TYPTYPE="1" TYPE="TD_TIMESTAMP">
    <TEXTS>
     <ITEM LANG="E" TEXT="Tilmestamp of the next timeout"/>
    </TEXTS>
   </ITEM>
  </ATTRIBUTS>
  <FRIENDS>
   <ITEM REFCLSNAME="YGPL_MT_INFORMATIONS" STATE="1"/>
   <ITEM REFCLSNAME="YGPL_MT_MESSAGING" STATE="1"/>
   <ITEM REFCLSNAME="YGPL_MT_OBJECTS" STATE="1"/>
   <ITEM REFCLSNAME="YGPL_MT_PROCESS" STATE="1"/>
  </FRIENDS>
  <INTERFACES>
   <ITEM REFCLSNAME="YGPL_MT_TYPES" EXPOSURE="2" STATE="1" RELTYPE="1"/>
  </INTERFACES>
  <LOCAL>
   <TYPES>`
*&quot;* use this source file for any type declarations (class
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* implementation or private method&apos;s signature</TYPES>
   <IMPLEMENTATIONS>`
*&quot;* local class implementation for public class
*&quot;* use this source file for the implementation part of
*&quot;* local helper classes</IMPLEMENTATIONS>
   <MACROS>`
*&quot;* use this source file for any macro definitions you need
*&quot;* in the implementation part of the class</MACROS>
  </LOCAL>
  <METHODS>
   <ITEM CMPNAME="CHECK_EXISTENCE_LOCK" EXPOSURE="1" STATE="1" MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Check Existence lock for a process"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="PROCESS_ID" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROCESS_ID">
      <TEXTS>
       <ITEM LANG="E" TEXT="Run/Task ID"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULT" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TD_BOOLEAN">
      <TEXTS>
       <ITEM LANG="E" TEXT="Run/task is running"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="YGPL_MT_CX" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="MultyThread : Root exception class"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA t_locks TYPE STANDARD TABLE OF seqg3.
  DATA _arg TYPE seqg3-garg.

  _arg = process_id.
  CONCATENATE sy-mandt _arg actions-existence INTO _arg.

  CALL FUNCTION &apos;ENQUEUE_READ&apos;
    EXPORTING
      gclient                     = sy-mandt
      gname                       = &apos;YGPLMT_LOCKS&apos;
      garg                        = _arg
      guname                      = &apos;&apos;
*     LOCAL                       = &apos; &apos;
*     FAST                        = &apos; &apos;
*   IMPORTING
*     NUMBER                      =
*     SUBRC                       =
    TABLES
      enq                         = t_locks
    EXCEPTIONS
      communication_failure       = 1
      system_failure              = 2
      OTHERS                      = 3.
  ASSERT sy-subrc = 0.

  IF NOT t_locks IS INITIAL.  result = abap_true.   ENDIF.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CHECK_LOCK_MODE" EXPOSURE="2" STATE="1" MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Check Lock mode is correct"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="LOCK_MODE" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_LOCK_MODE">
      <TEXTS>
       <ITEM LANG="E" TEXT="Lock mode (E, S, X)"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="YGPL_MT_CX" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="MultyThread : Root exception class"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  IF NOT lock_mode CO &apos;SEX&apos;.
    RAISE EXCEPTION TYPE ygpl_mt_cx_locks
          EXPORTING textid = ygpl_mt_cx_locks=&gt;invalid_lock_mode
                 lock_mode = lock_mode.
  ENDIF.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CHECK_TIMEOUT" EXPOSURE="2" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Check if timeout is reached"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="RESULT" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TD_BOOLEAN">
      <TEXTS>
       <ITEM LANG="E" TEXT="Timeout reached"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA _now TYPE td_timestamp.
  GET TIME STAMP FIELD _now.
  IF _now &gt; timeout.      result = abap_true.     ENDIF.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_INFORMATION_CLEARANCE" EXPOSURE="1" STATE="1" MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Check if actions on Process information is clear/authorized"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="RUN_ID" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROCESS_ID">
      <TEXTS>
       <ITEM LANG="E" TEXT="Run ID"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="TIMEOUT" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_TIME" PARVALUE="60">
      <TEXTS>
       <ITEM LANG="E" TEXT="Timeout value (second)"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="YGPL_MT_CX" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="MultyThread : Root exception class"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA _key TYPE string.
  DATA user TYPE sy-uname.

  set_timeout_timestamp( timeout ).
  DO.
    CALL FUNCTION &apos;ENQUEUE_EYGPLMT_LOCKS&apos;
      EXPORTING
        mode_ygplmt_locks       = lock_modes-read
        mandt                   = sy-mandt
        process_id              = run_id
        action                  = actions-information
        x_process_id            = abap_true
        x_action                = abap_true
        _scope                  = &apos;2&apos;
        _wait                   = abap_true
*     _COLLECT                = &apos; &apos;
      EXCEPTIONS
        foreign_lock            = 1
        system_failure          = 2
        OTHERS                  = 3.
    IF sy-subrc = 1.
      IF check_timeout( ) IS INITIAL.
        CONTINUE.
      ELSE.
        user = sy-msgv1.
        _key = run_id.
        RAISE EXCEPTION TYPE ygpl_mt_cx_locks
              EXPORTING textid = ygpl_mt_cx_locks=&gt;foreign_lock
                      object_name = &apos;MT Information&apos;(tis)
                       object_key = _key
                             user = user.
      ENDIF.
*  else if sy-subrc &lt;&gt; 0.
    ELSE.
      ASSERT sy-subrc = 0.
    ENDIF.
    CALL FUNCTION &apos;YGPL_DO_NOTHING&apos; IN UPDATE TASK.
    EXIT.
  ENDDO.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_MESSAGES_SEMAPHORE" EXPOSURE="1" STATE="1" MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Get Semaphore for Messages handling"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="PROCESS_ID" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROCESS_ID">
      <TEXTS>
       <ITEM LANG="E" TEXT="Run/Task ID"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="TIMEOUT" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_TIME" PARVALUE="60">
      <TEXTS>
       <ITEM LANG="E" TEXT="Timeout value (second)"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="YGPL_MT_CX" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="MultyThread : Root exception class"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA _key TYPE string.
  DATA user TYPE sy-uname.

  set_timeout_timestamp( timeout ).
  DO.
    CALL FUNCTION &apos;ENQUEUE_EYGPLMT_LOCKS&apos;
      EXPORTING
        mode_ygplmt_locks       = lock_modes-exclusive
        mandt                   = sy-mandt
        process_id              = process_id
        action                  = actions-messaging
        x_process_id            = abap_true
        x_action                = abap_true
        _scope                  = &apos;1&apos;
        _wait                   = abap_true
*     _COLLECT                = &apos; &apos;
      EXCEPTIONS
        foreign_lock            = 1
        system_failure          = 2
        OTHERS                  = 3.
    IF sy-subrc = 1.
      IF check_timeout( ) IS INITIAL.
        CONTINUE.
      ELSE.
        user = sy-msgv1.
        _key = process_id.
        RAISE EXCEPTION TYPE ygpl_mt_cx_locks
              EXPORTING textid = ygpl_mt_cx_locks=&gt;foreign_lock
                      object_name = &apos;Message Semaphore&apos;(tms)
                       object_key = _key
                             user = user.
      ENDIF.
*  else if sy-subrc &lt;&gt; 0.
    ELSE.
      ASSERT sy-subrc = 0.
    ENDIF.
    EXIT.
  ENDDO.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_OBJECTS_SEMAPHORE" EXPOSURE="1" STATE="1" MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Get Semaphore for Objects processing"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="RUN_ID" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROCESS_ID">
      <TEXTS>
       <ITEM LANG="E" TEXT="Run ID"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="TIMEOUT" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_TIME" PARVALUE="60">
      <TEXTS>
       <ITEM LANG="E" TEXT="Timeout value (second)"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="YGPL_MT_CX" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="MultyThread : Root exception class"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA _key TYPE string.
  DATA user TYPE sy-uname.

  set_timeout_timestamp( timeout ).
  DO.
    CALL FUNCTION &apos;ENQUEUE_EYGPLMT_LOCKS&apos;
      EXPORTING
        mode_ygplmt_locks       = lock_modes-exclusive
        mandt                   = sy-mandt
        process_id              = run_id
        action                  = actions-object
        x_process_id            = abap_true
        x_action                = abap_true
        _scope                  = &apos;1&apos;
        _wait                   = abap_true
*     _COLLECT                = &apos; &apos;
      EXCEPTIONS
        foreign_lock            = 1
        system_failure          = 2
        OTHERS                  = 3.
    IF sy-subrc = 1.
      IF check_timeout( ) IS INITIAL.
        CONTINUE.
      ELSE.
        user = sy-msgv1.
        _key = run_id.
        RAISE EXCEPTION TYPE ygpl_mt_cx_locks
              EXPORTING textid = ygpl_mt_cx_locks=&gt;foreign_lock
                      object_name = &apos;Object Semaphore&apos;(tos)
                       object_key = _key
                             user = user.
      ENDIF.
*  else if sy-subrc &lt;&gt; 0.
    ELSE.
      ASSERT sy-subrc = 0.
    ENDIF.
    EXIT.
  ENDDO.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_PROCESS_CLEARANCE" EXPOSURE="1" STATE="1" MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Check if actions on Process data is clear (authorized)"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="PROCESS_ID" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROCESS_ID">
      <TEXTS>
       <ITEM LANG="E" TEXT="Run/Task ID"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="TIMEOUT" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_TIME" PARVALUE="60">
      <TEXTS>
       <ITEM LANG="E" TEXT="Timeout value (second)"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="YGPL_MT_CX" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="MultyThread : Root exception class"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA _key TYPE string.
  DATA user TYPE sy-uname.

  set_timeout_timestamp( timeout ).
  DO.
    CALL FUNCTION &apos;ENQUEUE_EYGPLMT_LOCKS&apos;
      EXPORTING
        mode_ygplmt_locks       = lock_modes-read
        mandt                   = sy-mandt
        process_id              = process_id
        action                  = actions-process_data
        x_process_id            = abap_true
        x_action                = abap_true
        _scope                  = &apos;2&apos;
        _wait                   = abap_true
*     _COLLECT                = &apos; &apos;
      EXCEPTIONS
        foreign_lock            = 1
        system_failure          = 2
        OTHERS                  = 3.
    IF sy-subrc = 1.
      IF check_timeout( ) IS INITIAL.
        CONTINUE.
      ELSE.
        user = sy-msgv1.
        _key = process_id.
        RAISE EXCEPTION TYPE ygpl_mt_cx_locks
              EXPORTING textid = ygpl_mt_cx_locks=&gt;foreign_lock
                      object_name = &apos;MT Process Data&apos;(tds)
                       object_key = _key
                             user = user.
      ENDIF.
*  else if sy-subrc &lt;&gt; 0.
    ELSE.
      ASSERT sy-subrc = 0.
    ENDIF.
    CALL FUNCTION &apos;YGPL_DO_NOTHING&apos; IN UPDATE TASK.
    EXIT.
  ENDDO.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="RELEASE_EXISTENCE_LOCK" EXPOSURE="1" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Release Existence lock for a process"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="PROCESS_ID" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROCESS_ID">
      <TEXTS>
       <ITEM LANG="E" TEXT="Run/Task ID"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  CALL FUNCTION &apos;DEQUEUE_EYGPLMT_LOCKS&apos;
    EXPORTING
      MODE_YGPLMT_LOCKS       = &apos;E&apos;
      MANDT                   = SY-MANDT
      PROCESS_ID              = Process_id
      ACTION                  = actions-existence
      X_PROCESS_ID            = abap_true
      X_ACTION                = abap_true
      _SCOPE                  = &apos;1&apos;
*     _SYNCHRON               = &apos; &apos;
*     _COLLECT                = &apos; &apos;
            .</SOURCE>
   </ITEM>
   <ITEM CMPNAME="RELEASE_INFORMATION_CLEARANCE" EXPOSURE="1" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Release, previously get, information clearance"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="RUN_ID" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROCESS_ID">
      <TEXTS>
       <ITEM LANG="E" TEXT="Run ID"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  CALL FUNCTION &apos;DEQUEUE_EYGPLMT_LOCKS&apos;
    EXPORTING
      mode_ygplmt_locks       = lock_modes-read
      mandt                   = sy-mandt
      process_id              = run_id
      action                  = actions-information
      x_process_id            = abap_true
      x_action                = abap_true
      _scope                  = &apos;2&apos;
      _SYNCHRON               = &apos; &apos;
      _COLLECT                = &apos; &apos;.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="RELEASE_MESSAGES_SEMAPHORE" EXPOSURE="1" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Release, previously get, Semaphore for Messages handling"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="PROCESS_ID" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROCESS_ID">
      <TEXTS>
       <ITEM LANG="E" TEXT="Run/Task ID"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  CALL FUNCTION &apos;DEQUEUE_EYGPLMT_LOCKS&apos;
    EXPORTING
      mode_ygplmt_locks       = lock_modes-exclusive
      mandt                   = sy-mandt
      process_id              = process_id
      action                  = actions-messaging
      x_process_id            = abap_true
      x_action                = abap_true
      _scope                  = &apos;1&apos;
      _SYNCHRON               = &apos; &apos;
      _COLLECT                = &apos; &apos;.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="RELEASE_OBJECTS_SEMAPHORE" EXPOSURE="1" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Release, previously get, Semaphore for Objects processing"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="RUN_ID" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROCESS_ID">
      <TEXTS>
       <ITEM LANG="E" TEXT="Run ID"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  CALL FUNCTION &apos;DEQUEUE_EYGPLMT_LOCKS&apos;
    EXPORTING
      mode_ygplmt_locks       = lock_modes-exclusive
      mandt                   = sy-mandt
      process_id              = run_id
      action                  = actions-object
      x_process_id            = abap_true
      x_action                = abap_true
      _scope                  = &apos;1&apos;
      _SYNCHRON               = &apos; &apos;
      _COLLECT                = &apos; &apos;.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="RELEASE_PROCESS_CLEARANCE" EXPOSURE="1" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Release, previously get, data clearance"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="PROCESS_ID" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROCESS_ID">
      <TEXTS>
       <ITEM LANG="E" TEXT="Run/Task ID"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  CALL FUNCTION &apos;DEQUEUE_EYGPLMT_LOCKS&apos;
    EXPORTING
      mode_ygplmt_locks = lock_modes-read
      mandt             = sy-mandt
      process_id        = process_id
      action            = actions-process_data
      x_process_id      = abap_true
      x_action          = abap_true
      _scope            = &apos;2&apos;
      _synchron         = &apos; &apos;
      _collect          = &apos; &apos;.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="SET_EXISTENCE_LOCK" EXPOSURE="1" STATE="1" MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Set Existence lock for a process"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="PROCESS_ID" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROCESS_ID">
      <TEXTS>
       <ITEM LANG="E" TEXT="Run/Task ID"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="YGPL_MT_CX" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="MultyThread : Root exception class"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  CALL FUNCTION &apos;ENQUEUE_EYGPLMT_LOCKS&apos;
    EXPORTING
      MODE_YGPLMT_LOCKS       = lock_modes-write
      MANDT                   = SY-MANDT
      PROCESS_ID              = Process_id
      ACTION                  = actions-existence
      X_PROCESS_ID            = abap_true
      X_ACTION                = abap_true
      _SCOPE                  = &apos;1&apos;
      _WAIT                   = ABAP_true
*     _COLLECT                = &apos; &apos;
    EXCEPTIONS
      FOREIGN_LOCK            = 1
      SYSTEM_FAILURE          = 2
      OTHERS                  = 3.
  ASSERT sy-subrc = 0.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="SET_TIMEOUT_TIMESTAMP" EXPOSURE="2" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Compute timestamp of the timeout"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="TIMEOUT" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_TIME">
      <TEXTS>
       <ITEM LANG="E" TEXT="Delay in second from now"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  GET TIME STAMP FIELD ygpl_mt_lock_managment=&gt;timeout.
  ygpl_mt_lock_managment=&gt;timeout =  cl_abap_tstmp=&gt;add( tstmp = ygpl_mt_lock_managment=&gt;timeout
                                                          secs = timeout ).</SOURCE>
   </ITEM>
  </METHODS>
  <TEXTSPOOL>
   <ITEM ID="I" KEY="TDS">
    <TEXTS>
     <ITEM LANGU="E" ENTRY="MT Process Data" LENGTH="30 "/>
    </TEXTS>
   </ITEM>
   <ITEM ID="I" KEY="TIS">
    <TEXTS>
     <ITEM LANGU="E" ENTRY="MT Information" LENGTH="30 "/>
    </TEXTS>
   </ITEM>
   <ITEM ID="I" KEY="TMS">
    <TEXTS>
     <ITEM LANGU="E" ENTRY="Message Semaphore" LENGTH="30 "/>
    </TEXTS>
   </ITEM>
   <ITEM ID="I" KEY="TOS">
    <TEXTS>
     <ITEM LANGU="E" ENTRY="Object Semaphore" LENGTH="30 "/>
    </TEXTS>
   </ITEM>
  </TEXTSPOOL>
 </RAW>
</ZL_OBJECT>
