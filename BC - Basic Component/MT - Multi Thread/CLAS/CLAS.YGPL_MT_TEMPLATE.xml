<?xml version="1.0" encoding="utf-16"?>
<ZL_OBJECT CHECKSUM="7FF3B4C8B5B113C0E3F38E5D7F3E1489" CODE_SIGNATURE="73B361EA0742C6B8898A4C5A2CD3239D" CONNECTOR="39AC0A4B07A5A05AE1000000AC120173" NAME="YGPL_MT_TEMPLATE" TYPE="CLAS" VERSION="1.01">
 <DIRECTORY DEVCLASS="YGPL-MULTITHREAD" MASTERLANG="F"/>
 <RAW>
  <A0_MAINDATA VERSION="1" LANGU="F" EXPOSURE="2" STATE="1" CLSFINAL="X" CLSCCINCL="X" FIXPT="X" UNICODE="X">
   <INHERITANCE REFCLSNAME="YGPL_MT_ROOTCLASS" STATE="1"/>
   <TEXTS>
    <ITEM LANG="F" TEXT="Multi-Thread Template"/>
   </TEXTS>
  </A0_MAINDATA>
  <LOCAL>
   <TYPES>`
*&quot;* use this source file for any type declarations (class
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* implementation or private method&apos;s signature</TYPES>
   <IMPLEMENTATIONS>`
*&quot;* local class implementation for public class
*&quot;* use this source file for the implementation part of
*&quot;* local helper classes</IMPLEMENTATIONS>
   <MACROS>`
*&quot;* use this source file for any macro definitions you need
*&quot;* in the implementation part of the class</MACROS>
  </LOCAL>
  <METHODS>
   <ITEM CMPNAME="CONSTRUCTOR" EXPOSURE="2" STATE="1" MTDTYPE="2">
    <TEXTS>
     <ITEM LANG="F" TEXT="CONSTRUCTOR"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="MAX_MEM" CMPTYPE="1" MTDTYPE="2" PARPASSTYP="1" TYPTYPE="1" TYPE="T_MEM_SIZE" PARVALUE="0" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANG="F" TEXT="Estimated Memory size of the bloc"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RUN_ID" CMPTYPE="1" MTDTYPE="2" PARPASSTYP="1" TYPTYPE="1" TYPE="T_RUN" PAROPTIONL="X" PARPREFERD="X">
      <TEXTS>
       <ITEM LANG="F" TEXT="ID unique de l&apos;exécution"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="FAILED" LANGU="F" MTDTYPE="2">
      <TEXTS>
       <ITEM LANG="F" TEXT="Création de l&apos;objet à échoué"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  CALL METHOD super-&gt;constructor
    EXPORTING
      run_id  = run_id
      max_mem = max_mem.

  CALL METHOD _define_cat_type
    EXPORTING
      cat             = ygpl_mt_my_categori=&gt;params
      data_type       = &apos;YGPL_MT_TEMPLATE=&gt;TS_PARAM&apos;
    EXCEPTIONS
      failed          = 1
      wrong_data_type = 2
      system_cat      = 3
      cat_not_found   = 4
      OTHERS          = 5.
  IF sy-subrc &lt;&gt; 0.
    RAISE failed.
  ENDIF.

* Auto registration
  set handler me-&gt;handle_msg for me.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_BATCH" EXPOSURE="2" STATE="1">
    <TEXTS>
     <ITEM LANG="F" TEXT="Get a batch (n blocs)c"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="OBJECTS" CMPTYPE="1" PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_DATA">
      <TEXTS>
       <ITEM LANG="F" TEXT="Liste d&apos;objet générique"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="WAIT" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="T_BOOLEAN" PARVALUE="&apos;X&apos;" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANG="F" TEXT="Attendre"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="FAILED" LANGU="F">
      <TEXTS>
       <ITEM LANG="F" TEXT="Run creation has failed"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="FOREIGN_LOCK" LANGU="F">
      <TEXTS>
       <ITEM LANG="F" TEXT="Objet déjà bloqué"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
**********************************************************************
* Author : Al&apos;oustad Taryck BENSIALI (taryck.bensiali@gmail.com)     *
* Date : 2008 December                                               *
**********************************************************************
*  TRY.
  CALL METHOD _get_batch
    EXPORTING
      wait         = wait
    IMPORTING
      OBJECTS      = OBJECTS
    EXCEPTIONS
      failed       = 1
      foreign_lock = 2
      OTHERS       = 3.
  IF sy-subrc = 1.
    RAISE foreign_lock.
  ELSEIF sy-subrc &lt;&gt; 0.
    RAISE failed.
  ENDIF.
*    CATCH SYSTEM-EXCEPTIONS.
*      RAISE failed.
*  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="HANDLE_MSG" EXPOSURE="2" STATE="1" MTDTYPE="1" REFCLSNAME="YGPL_MT_TEMPLATE" REFCMPNAME="HANDLE_SPECIFIC_MSG">
    <TEXTS>
     <ITEM LANG="F" TEXT="Traite les messages spécifiques"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CAT" CMPTYPE="1" MTDTYPE="1"/>
     <ITEM SCONAME="RAWDATA" CMPTYPE="1" MTDTYPE="1"/>
    </PARAMETERS>
    <SOURCE>`
  DATA:
    _param TYPE ygpl_mt_template=&gt;ts_param.

  CASE cat.
    WHEN ygpl_mt_my_categori=&gt;params.
      CALL METHOD ygpl_mt_rootclass=&gt;conv_raw2data
        EXPORTING
          rawdata = rawdata
        CHANGING
          data    = _param.
      WRITE:/ &apos;Thread wait time&apos;, _param.
    WHEN OTHERS.
      WRITE:/ &apos;Unkown message cat : &apos;, cat.
  ENDCASE.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="LOAD_RUN" EXPOSURE="2" STATE="1">
    <TEXTS>
     <ITEM LANG="F" TEXT="Generic Run initialisation"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="BLOC_SIZE" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="T_BLOC_SIZE" PARVALUE="5000" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANG="F" TEXT="Taille du bloc"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="DEPENDENCIES" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_DEPENDENCIES" PAROPTIONL="X"/>
     <ITEM SCONAME="OBJECTS" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_DATA"/>
     <ITEM SCONAME="THREADS" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="INT4">
      <TEXTS>
       <ITEM LANG="F" TEXT="Entier naturel"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="FAILED" LANGU="F">
      <TEXTS>
       <ITEM LANG="F" TEXT="Run creation has failed"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
**********************************************************************
* Author : Al&apos;oustad Taryck BENSIALI (taryck.bensiali@gmail.com)     *
* Date : 2008 December                                               *
**********************************************************************

*  TRY.
      CALL METHOD _load_run
        EXPORTING
          threads      = threads
          OBJECTS      = OBJECTS
          bloc_size    = bloc_size
          weight_FN    = &apos;WEIGHT&apos;
          DEPENDENCIES = DEPENDENCIES
        EXCEPTIONS
          failed    = 1
          OTHERS    = 2.
      IF sy-subrc &lt;&gt; 0.
        RAISE failed.
      ENDIF.
*    CATCH SYSTEM-EXCEPTIONS.
*      RAISE failed.
*  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="SEND_PARAM" EXPOSURE="2" STATE="1">
    <TEXTS>
     <ITEM LANG="F" TEXT="Send parameters to DB"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="WAIT_TIME" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TS_PARAM">
      <TEXTS>
       <ITEM LANG="F" TEXT="Donnée du message"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="FAILED" LANGU="F">
      <TEXTS>
       <ITEM LANG="F" TEXT="Action has failed"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
**********************************************************************
* Author : Al&apos;oustad Taryck BENSIALI (taryck.bensiali@gmail.com)     *
* Date : 2008 December                                               *
**********************************************************************

  CALL METHOD send_message
    EXPORTING
      cat                 = ygpl_mt_my_categori=&gt;params
      msg                 = WAIT_TIME
    EXCEPTIONS
      system_cat          = 1
      cat_not_found       = 2
      failed              = 3
      cat_has_no_datatype = 4
      others              = 5.
  IF sy-subrc &lt;&gt; 0.
    raise failed.
  ENDIF.</SOURCE>
   </ITEM>
  </METHODS>
  <TYPES>
   <ITEM CMPNAME="TS_DATA" EXPOSURE="2" STATE="1" TYPTYPE="4">
    BEGIN OF ts_data,
        MSG TYPE T100A-ARBGB,
        Lang type tt_lang,
        Weight type i,
      end of ts_data
`
    <TEXTS>
     <ITEM LANG="F" TEXT="Structure de donnée"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TS_LANG" EXPOSURE="2" STATE="1" TYPTYPE="4">BEGIN OF ts_Lang,
        LANGU TYPE T100T-SPRSL,
        TEXT type string,
      end of ts_Lang
`</ITEM>
   <ITEM CMPNAME="TS_PARAM" EXPOSURE="2" STATE="1" TYPTYPE="1" TYPE="T_TIME">
    <TEXTS>
     <ITEM LANG="F" TEXT="durée effective d&apos;attente du thread"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TT_DATA" EXPOSURE="2" STATE="1" TYPTYPE="4">
    tt_data TYPE STANDARD TABLE OF ts_data WITH NON-UNIQUE KEY MSG
`
    <TEXTS>
     <ITEM LANG="F" TEXT="Table de donnée"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TT_LANG" EXPOSURE="2" STATE="1" TYPTYPE="4">tt_Lang TYPE STANDARD TABLE OF ts_lang WITH non-UNIQUE KEY LANGU
`</ITEM>
  </TYPES>
 </RAW>
</ZL_OBJECT>
